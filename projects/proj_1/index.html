<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Prokudin-Gorskii Photo Collection | Naman Satish </title> <meta name="author" content="Naman Shimoga Satish"> <meta name="description" content="Part of CS180 : Intro to Computer Vision and Computational Photography"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.4/dist/bootstrap-table.min.css" integrity="sha256-uRX+PiRTR4ysKFRCykT8HLuRCub26LgXJZym3Yeom1c=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%90&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://satish.dev/projects/proj_1/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/img-comparison-slider@8.0.6/dist/styles.min.css" integrity="sha256-3qTIuuUWIFnnU3LpQMjqiXc0p09rvd0dmj+WkpQXSR8=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11.0.5/swiper-bundle.min.css" integrity="sha256-yUoNxsvX+Vo8Trj3lZ/Y5ZBf8HlBFsB6Xwm7rH75/9E=" crossorigin="anonymous"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Naman Satish </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Prokudin-Gorskii Photo Collection</h1> <p class="post-description">Part of CS180 : Intro to Computer Vision and Computational Photography</p> </header> <article> <p>Sergei Mikhailovich Prokudin-Gorskii (1863–1944), a Russian photographer and chemist, is best known for his work in early color photography. While color photography was still in its infancy, Prokudin-Gorskii created a camera capable of taking color images by capturing separate black-and-white photographs through red, green, and blue filters. Prokudin-Gorskii believed that eventually, these images would be able to be viewed in color through a specialized projector.</p> <p>Although Prokudin-Gorskii’s dream of color photography was never realized, his work has been digitized and colorized by various individuals and organizations. The Library of Congress has a collection of over 2,000 of his images, which can be viewed <a href="https://www.loc.gov/collections/prokudin-gorskii/" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>In this project, my goal is to colorize his one-of-a-kind images.</p> <h2 id="original-images">Original Images</h2> <p>As we can see, Prokudin-Gorskii’s pictures were taken in three separate black-and-white images, each with a red, green, or blue filter. The top exposure has been shot with a blue filter, the middle with a green filter, and the bottom with a red filter.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/data_jpgs/onion_church-480.webp 480w,/assets/img/cs180/proj1/data_jpgs/onion_church-800.webp 800w,/assets/img/cs180/proj1/data_jpgs/onion_church-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/data_jpgs/onion_church.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Onion Church" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/data_jpgs/train-480.webp 480w,/assets/img/cs180/proj1/data_jpgs/train-800.webp 800w,/assets/img/cs180/proj1/data_jpgs/train-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/data_jpgs/train.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Train" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Prokudin-Gorskii's original images. Left: Onion Church. Right: Train. </div> <p>From a first glance, it is clear that the channels are not perfectly aligned, nor are their dimensions always the same. In the Onion Church’s blue channel, part of the onion dome is cut off, and the red channel seems cut short on both the top and bottom. The train’s entire slide appears larger than the Onion Church’s.</p> <h2 id="naive-approach">Naive Approach</h2> <p>To colorize the images, I first tried a naive approach. I simply stacked the three images on each other and used the red, green, and blue channels to create a color image.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Read in the image
</span><span class="n">img</span> <span class="o">=</span> <span class="n">skio</span><span class="p">.</span><span class="nf">imread</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>

<span class="c1"># Convert to double
</span><span class="n">img</span> <span class="o">=</span> <span class="n">sk</span><span class="p">.</span><span class="nf">img_as_float</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

<span class="c1"># Compute the height of each channel (just 1/3 of total)
</span><span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="n">img</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Separate color channels
</span><span class="n">b</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:</span><span class="n">height</span><span class="p">]</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="n">height</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">height</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">height</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">height</span><span class="p">]</span>

<span class="c1">#Naive Alignment
</span><span class="n">stacked</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dstack</span><span class="p">((</span><span class="n">r</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
</code></pre></div></div> <p>The results of this naive approach can be seen below.</p> <swiper-container keyboard="true" navigation="true" pagination="true" pagination-clickable="true" autoplay="true" loop="true" speed="500" autoplay-delay="2500" autoplay-disable-on-interaction="false"> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/cathedral-480.webp 480w,/assets/img/cs180/proj1/naive/cathedral-800.webp 800w,/assets/img/cs180/proj1/naive/cathedral-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/cathedral.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Cathedral" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/church-480.webp 480w,/assets/img/cs180/proj1/naive/church-800.webp 800w,/assets/img/cs180/proj1/naive/church-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/church.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Church" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/emir-480.webp 480w,/assets/img/cs180/proj1/naive/emir-800.webp 800w,/assets/img/cs180/proj1/naive/emir-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/emir.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Emir" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/harvesters-480.webp 480w,/assets/img/cs180/proj1/naive/harvesters-800.webp 800w,/assets/img/cs180/proj1/naive/harvesters-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/harvesters.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Harvesters" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/icon-480.webp 480w,/assets/img/cs180/proj1/naive/icon-800.webp 800w,/assets/img/cs180/proj1/naive/icon-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/icon.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Icon" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/lady-480.webp 480w,/assets/img/cs180/proj1/naive/lady-800.webp 800w,/assets/img/cs180/proj1/naive/lady-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/lady.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Lady" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/melons-480.webp 480w,/assets/img/cs180/proj1/naive/melons-800.webp 800w,/assets/img/cs180/proj1/naive/melons-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/melons.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Melons" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/monastery-480.webp 480w,/assets/img/cs180/proj1/naive/monastery-800.webp 800w,/assets/img/cs180/proj1/naive/monastery-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/monastery.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Monastery" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/onion_church-480.webp 480w,/assets/img/cs180/proj1/naive/onion_church-800.webp 800w,/assets/img/cs180/proj1/naive/onion_church-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/onion_church.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Onion Church" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/sculpture-480.webp 480w,/assets/img/cs180/proj1/naive/sculpture-800.webp 800w,/assets/img/cs180/proj1/naive/sculpture-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/sculpture.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Sculpture" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/self_portrait-480.webp 480w,/assets/img/cs180/proj1/naive/self_portrait-800.webp 800w,/assets/img/cs180/proj1/naive/self_portrait-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/self_portrait.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Self Portrait" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/three_generations-480.webp 480w,/assets/img/cs180/proj1/naive/three_generations-800.webp 800w,/assets/img/cs180/proj1/naive/three_generations-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/three_generations.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Three Generations" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/tobolsk-480.webp 480w,/assets/img/cs180/proj1/naive/tobolsk-800.webp 800w,/assets/img/cs180/proj1/naive/tobolsk-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/tobolsk.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Tobolsk" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/naive/train-480.webp 480w,/assets/img/cs180/proj1/naive/train-800.webp 800w,/assets/img/cs180/proj1/naive/train-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/naive/train.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Train" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> </swiper-container> <div class="caption"> Naive approach to colorizing Prokudin-Gorskii's images. </div> <p>As we can see, the naive approach performs very poorly. Due to the mis-alignment of the images, the produced color image is not an accurate depiction of Prokudin-Gorskii’s intended image.</p> <h2 id="single-scale-alignment">Single Scale Alignment</h2> <p>The first approach I took towards aligning the images was to use a relatively simple and brute force approach, sliding the image over each other to compare the similarity. I allowed maximum displacements of 15 px of each dimension, allowing for some leeway given that images were not perfectly square. I fixed the blue channel and aligned the green and red channels. This resulted in displacement vectors for the green and red channels that I could use to produce an aligned image.</p> <h3 id="alignment-metric">Alignment Metric</h3> <p>While sliding the images over each other, it may be easy for a human to tell when they are aligned, however, it is not so trivial for a computer. To align our images we need to have a metric to quantify the alignment of the images. The one that I settled upon was the Normalized Dot Product.</p> \[A \cdot B = \|A\| \cdot \|B\| \cdot \cos(\theta)\] <p>Where \(\|A\|\) and \(\|B\|\) are the magnitudes of the vectors and \(\theta\) is the angle between them. The normalized dot product is defined as:</p> \[NDP = \frac{A \cdot B}{\|A\| \cdot \|B\|}\] <p>With some algebra, we can see that the normalized dot product is equal to the cosine similarity between the two vectors. The cosine similarity is a measure of similarity between two non-zero vectors of an inner product space. The cosine of 0 degrees is 1, and decreases for any other angle. Thus we have our metric, where the closer the normalized dot product is to 1, the more “aligned” we believe the images to be.</p> <p>However, at the resolutions where a single scale level approach is reasonable (the search space increases exponentially as the image grows), I found that often using a metric such as the Normalized Dot Product or Mean Squared Error was not enough to accurately align the images. The images would often be content with 0,0 displacement. As such, I decided to use an extracted feature from the images to align them.</p> <h3 id="alignment-heuristic">Alignment Heuristic</h3> <p>I settled on using image edges as the feature to align the images. While I originally developed my own rudimentary edge detector by traversing the image top to bottom and left to right, and noting changes over a threshold, and merging them with a logical or, the custom edge detection was both slow and unreliable for larger images. I used the Canny edge detector to extract the edges from the images.</p> <p>Before extracting the edges from our image, it is important to note that because our images are noisy, this can greatly hamper the output of our edge detection.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/extras/edge_detection_comparison-480.webp 480w,/assets/img/cs180/proj1/extras/edge_detection_comparison-800.webp 800w,/assets/img/cs180/proj1/extras/edge_detection_comparison-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/extras/edge_detection_comparison.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Edge Detection Comparison" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> An example of how Gaussian blurring helps preserve edges and remove noise. </div> <p>Lastly, because the border of Prokudin-Gorskii’s images are white and then black, the edge detection produces very strong lines that are not affected by the Gaussian blurring. These lines are not features that we want to consider in aligning our image because the border does not correspond to the actual alignment of the image. Therefore, we take a 15% crop on all sides of the channel, removing the border and any defects that may have arisen from the border intruding into the exposure.</p> <h3 id="conclusion">Conclusion</h3> <p>Our final result processes the JPEGs from Prokudin-Gorskii’s collection in a matter of seconds. I am using the common image coordinate system, where the origin is at the top left corner of the image, the x-axis is positive to the right, and the y-axis is positive downwards. The dY, and dX values are the displacements in the y and x directions respectively.</p> <table id="table" data-toggle="table" data-url="/assets/json/cs180/proj1/jpg_results.json"> <thead> <tr> <th data-field="name">Name</th> <th data-field="time">Computation Time(s)</th> <th data-field="green_y_offset">Green dY</th> <th data-field="green_x_offset">Green dX</th> <th data-field="red_y_offset">Red dY</th> <th data-field="red_x_offset">Red dX</th> </tr> </thead> </table> <h3 id="examples">Examples</h3> <swiper-container keyboard="true" navigation="true" pagination="true" pagination-clickable="true" autoplay="true" loop="true" speed="500" autoplay-delay="5000" autoplay-disable-on-interaction="false"> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/monastery-480.webp 480w,/assets/img/cs180/proj1/output/monastery-800.webp 800w,/assets/img/cs180/proj1/output/monastery-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/monastery.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Monastery" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/tobolsk-480.webp 480w,/assets/img/cs180/proj1/output/tobolsk-800.webp 800w,/assets/img/cs180/proj1/output/tobolsk-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/tobolsk.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Tobolsk" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/cathedral-480.webp 480w,/assets/img/cs180/proj1/output/cathedral-800.webp 800w,/assets/img/cs180/proj1/output/cathedral-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/cathedral.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Cathedral" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> </swiper-container> <h2 id="multi-scale-alignment">Multi-Scale Alignment</h2> <p>We will now be dealing with much larger images, where each channel’s dimensions are around 3 thousand pixels. A 10% displacement in each direction would result in a search space of 300 by 300 pixels. This 90,000 pixel search space is not feasible to search through, and as such we will be using a multi-scale approach to align our images.</p> <h3 id="gaussian-pyramids">Gaussian Pyramids</h3> <p>To represent images are lower resolutions, we will be using Gaussian Pyramids. A Gaussian Pyramid is a collection of images, where each image is a smoothed and downscaled version of the image below it. The bottom of the pyramid is the original image, and the top of the pyramid is the smallest image, as such the pyramid consists of layers. By convention, the original image is the 0th layer, and the smallest image is the \(k\)th layer.</p> <h3 id="formula-for-maximum-displacement">Formula for Maximum Displacement</h3> <p>We can make some observations at this point. Because at each layer our displacement from the layer above doubles, there must be an optimal displacement range such that we can attain a large alignment precision. At layer \(k\), a single pixel shift corresponds to a shift of \(2^k\) pixels in the original image. Our maximum displacement can be considered another value, let’s use \(r\), and the area we are trying to cover, in our earlier example 15%, can become \(p\). Additionally, let us consider our highest layer to be \(L\). \(n\) is the number of pixels in the dimension we are trying to align.</p> \[p \cdot n = \sum_{k=0}^{L} r \cdot {2^k}\] \[p \cdot n = ({2^{L+1} - 1}) \cdot r\] \[\left(\frac{p \cdot n}{2^{L+1}-1}\right) = r\] <p>Now that we have a formula for our maximum displacement, we must decide on fixing the variables \(p\) and \(L\). Upon rounds of testing, and specific increases to allow for the alignment of melons, I settled on \(p\) to be 10%. Because \(r\) decreases as \(L\) increases, a higher \(L\) will allow for a faster alignment, as there will be more layers, but the search space in each will be smaller. This is trading the exponential growth of the search space for the linear growth of the number of layers. However, as L increases, the resolution of the image decreases, and the edge heuristics become less reliable. I settled on computing and choosing an \(L\) such that the smallest dimension of the image at layer \(L\) is ~50 pixels.</p> <p>This method was shared with the single scale alignment, however, because there are 0 layers, it increased the search space to 10% of the level 0 image, usually around 300 pixels. This resulted in slightly higher computation times than before, but still on the order of seconds, so the times above are from this version.</p> <h3 id="conclusion-1">Conclusion</h3> <p>The multi-scale alignment approach is able to align the images with a high degree of accuracy and with incredible speed! The images are aligned in a matter of seconds, and the results are quite impressive. While using a fixed L of 5, the tiff images took on the order of 4 minutes to complete alignment at level 0. However, with a variable L, the images are aligned in a matter of seconds.</p> <table id="table" data-toggle="table" data-url="/assets/json/cs180/proj1/tiff_results.json"> <thead> <tr> <th data-field="name">Name</th> <th data-field="time">Computation Time(s)</th> <th data-field="green_y_offset">Green dY</th> <th data-field="green_x_offset">Green dX</th> <th data-field="red_y_offset">Red dY</th> <th data-field="red_x_offset">Red dX</th> </tr> </thead> </table> <h3 id="examples-1">Examples</h3> <swiper-container keyboard="true" navigation="true" pagination="true" pagination-clickable="true" autoplay="true" loop="true" speed="500" autoplay-delay="5000" autoplay-disable-on-interaction="false"> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/church-480.webp 480w,/assets/img/cs180/proj1/output/church-800.webp 800w,/assets/img/cs180/proj1/output/church-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/church.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Church" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/emir-480.webp 480w,/assets/img/cs180/proj1/output/emir-800.webp 800w,/assets/img/cs180/proj1/output/emir-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/emir.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Emir" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/harvesters-480.webp 480w,/assets/img/cs180/proj1/output/harvesters-800.webp 800w,/assets/img/cs180/proj1/output/harvesters-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/harvesters.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Harvesters" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/icon-480.webp 480w,/assets/img/cs180/proj1/output/icon-800.webp 800w,/assets/img/cs180/proj1/output/icon-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/icon.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Icon" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/lady-480.webp 480w,/assets/img/cs180/proj1/output/lady-800.webp 800w,/assets/img/cs180/proj1/output/lady-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/lady.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Lady" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/melons-480.webp 480w,/assets/img/cs180/proj1/output/melons-800.webp 800w,/assets/img/cs180/proj1/output/melons-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/melons.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Melons" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/onion_church-480.webp 480w,/assets/img/cs180/proj1/output/onion_church-800.webp 800w,/assets/img/cs180/proj1/output/onion_church-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/onion_church.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Onion Church" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/sculpture-480.webp 480w,/assets/img/cs180/proj1/output/sculpture-800.webp 800w,/assets/img/cs180/proj1/output/sculpture-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/sculpture.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Sculpture" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/self_portrait-480.webp 480w,/assets/img/cs180/proj1/output/self_portrait-800.webp 800w,/assets/img/cs180/proj1/output/self_portrait-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/self_portrait.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Self Portrait" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/three_generations-480.webp 480w,/assets/img/cs180/proj1/output/three_generations-800.webp 800w,/assets/img/cs180/proj1/output/three_generations-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/three_generations.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Three Generations" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cs180/proj1/output/train-480.webp 480w,/assets/img/cs180/proj1/output/train-800.webp 800w,/assets/img/cs180/proj1/output/train-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cs180/proj1/output/train.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Train" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </swiper-slide> </swiper-container> <h2 id="side-notes">Side Notes</h2> <p>Some other ideas I tried included using phase-based correlation to align the images, however after refactoring my code, I found that the function was no longer working. Regardless, I was able to verify the accuracy of my alignment using sci-kit image’s phase-based correlation method and found that my alignment agreed well with the results of the phase-based correlation. This satisfied me with the knowledge that my methodology was validated by fft frequency correlation.a</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Naman Shimoga Satish. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.4/dist/bootstrap-table.min.js" integrity="sha256-4rppopQE9POKfukn2kEvhJ9Um25Cf6+IDVkARD0xh78=" crossorigin="anonymous"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script defer src="https://cdn.jsdelivr.net/npm/img-comparison-slider@8.0.6/dist/index.min.js" integrity="sha256-EXHg3x1K4oIWdyohPeKX2ZS++Wxt/FRPH7Nl01nat1o=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/swiper@11.0.5/swiper-element-bundle.min.js" integrity="sha256-BPrwikijIybg9OQC5SYFFqhBjERYOn97tCureFgYH1E=" crossorigin="anonymous"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-projects",title:"projects",description:"A growing collection of your cool projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-cv",title:"cv",description:"Naman Satish's CV",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"post-computational-photography",title:"Computational Photography",description:"Experimenting with computational photography on vacation!",section:"Posts",handler:()=>{window.location.href="/blog/2024/computational-photography/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-handshake-bot",title:"Handshake Bot",description:"Final Project in C106A : Introduction to Robotics",section:"Projects",handler:()=>{window.location.href="/projects/106a_final/"}},{id:"projects-apollo-augmenting-light-functions-to-simulate-wave-based-diffraction",title:"Apollo: Augmenting Light Functions to Simulate Wave-Based Diffraction",description:"Final Project in CS184 : Foundations of Computer Graphics",section:"Projects",handler:()=>{window.location.href="/projects/184_proposal/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"projects-rasterizer",title:"Rasterizer",description:"Part of CS184 : Foundations of Computer Graphics",section:"Projects",handler:()=>{window.location.href="/projects/homework_1/"}},{id:"projects-bezier-curves-and-triangle-meshes",title:"Bezier Curves and Triangle Meshes",description:"Part of CS184 : Foundations of Computer Graphics",section:"Projects",handler:()=>{window.location.href="/projects/homework_2/"}},{id:"projects-path-tracing",title:"Path Tracing",description:"Part of CS184 : Foundations of Computer Graphics",section:"Projects",handler:()=>{window.location.href="/projects/homework_3/"}},{id:"projects-prokudin-gorskii-photo-collection",title:"Prokudin-Gorskii Photo Collection",description:"Part of CS180 : Intro to Computer Vision and Computational Photography",section:"Projects",handler:()=>{window.location.href="/projects/proj_1/"}},{id:"projects-filters-amp-frequencies",title:"Filters & Frequencies",description:"Part of CS180 : Intro to Computer Vision and Computational Photography",section:"Projects",handler:()=>{window.location.href="/projects/proj_2/"}},{id:"projects-face-morphing",title:"Face Morphing",description:"Part of CS180 : Intro to Computer Vision and Computational Photography",section:"Projects",handler:()=>{window.location.href="/projects/proj_3/"}},{id:"projects-auto-stitching-and-photo-mosaics",title:"(Auto)Stitching and Photo Mosaics",description:"Part of CS180 : Intro to Computer Vision and Computational Photography",section:"Projects",handler:()=>{window.location.href="/projects/proj_4/"}},{id:"projects-diffusion-models",title:"Diffusion Models",description:"Part of CS180 : Intro to Computer Vision and Computational Photography",section:"Projects",handler:()=>{window.location.href="/projects/proj_5/"}},{id:"projects-neural-radiance-fields",title:"Neural Radiance Fields",description:"Final Project in CS180 : Intro to Computer Vision and Computational Photography",section:"Projects",handler:()=>{window.location.href="/projects/proj_final/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%6E%61%6D%61%6E@%62%65%72%6B%65%6C%65%79.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=qc6CJjYAAAAJ","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>